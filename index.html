<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åˆ›ä¸šè¥¿å®‰ 2026æ¼è›‹åˆ†ç»„å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            word-wrap: break-word;
            word-break: break-all;
        }
        body {
            font-family: "å¾®è½¯é›…é»‘", "é»‘ä½“", Arial, sans-serif;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            min-height: 100vh;
            padding: 10px 0;
            width: 100%;
            overflow-x: hidden;
        }
        .container {
            max-width: 900px;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            background: url("https://img.icons8.com/color/1600/playing-cards.png") no-repeat center 20px;
            background-size: 80px;
            background-color: #fff;
            border-radius: 20px;
            padding: 20px 15px;
            box-shadow: 0 10px 30px rgba(255, 105, 0, 0.3);
            border: 5px solid #d4af37;
            overflow: hidden;
        }
        h1 {
            color: #c8102e;
            font-size: 24px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            width: 100%;
        }
        /* æ–°å¢ï¼šè£åˆ¤ä¿¡æ¯æ ·å¼ */
        .referee-info {
            font-size: 18px;
            color: #c8102e;
            font-weight: bold;
            margin: 10px 0;
            padding: 8px;
            background-color: rgba(255, 215, 0, 0.1);
            border-radius: 8px;
            width: 100%;
        }
        /* å†å²è®°å½•åŒºåŸŸæ ·å¼ */
        .history-section {
            margin: 15px 0;
            padding: 10px;
            border: 2px dashed #ffd700;
            border-radius: 10px;
            background-color: rgba(255, 251, 235, 0.8);
            width: 100%;
        }
        .history-section h3 {
            color: #8b4513;
            font-size: 16px;
            margin-bottom: 8px;
        }
        .history-content {
            color: #5a3e2b;
            font-size: 14px;
            line-height: 1.6;
            width: 100%;
        }
        .history-empty {
            color: #999;
            font-style: italic;
        }
        /* æ¼è›‹æ¡Œå¸ƒå±€ - å“åº”å¼å°ºå¯¸ */
        .seats-wrapper {
            position: relative;
            width: 90vw;
            max-width: 600px;
            height: 90vw;
            max-height: 600px;
            margin: 15px auto;
            background: radial-gradient(circle, #f9f2e8 0%, #e8d4b8 100%);
            border-radius: 50%;
            border: 8px solid #8b4513;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.2), 0 0 20px rgba(139, 69, 19, 0.4);
        }
        .seat {
            position: absolute;
            width: 20vw;
            max-width: 140px;
            height: 24vw;
            max-height: 180px;
            background: linear-gradient(180deg, #ffffff 0%, #f8f0e3 100%);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 3px solid #c8102e;
            padding: 8px;
            transition: all 0.3s ease;
        }
        /* æˆ¿ä¸»é«˜äº®æ ·å¼ */
        .seat.host {
            border-color: #ffd700;
            background: linear-gradient(180deg, #fff8dc 0%, #fff3cd 100%);
            box-shadow: 0 0 20px #ffd700;
        }
        .host-tag {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #ffd700;
            color: #c8102e;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 8px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        /* åº§ä½æ–¹ä½å®šä½ */
        .seat.north { top: 2%; left: 50%; transform: translateX(-50%); }
        .seat.south { bottom: 2%; left: 50%; transform: translateX(-50%); }
        .seat.west { left: 2%; top: 50%; transform: translateY(-50%); }
        .seat.east { right: 2%; top: 50%; transform: translateY(-50%); }
        
        .seat .direction {
            color: #c8102e;
            font-size: 16px;
            margin-bottom: 6px;
            font-weight: bold;
        }
        .seat .avatar {
            width: 12vw;
            max-width: 90px;
            height: 12vw;
            max-height: 90px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 6px;
            border: 4px solid #ffd700;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }
        .seat .person {
            font-size: 14px;
            color: #333;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        /* ä¸­é—´æ ‡é¢˜ */
        .center-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 6vw;
            max-font-size: 38px;
            font-weight: bold;
            color: #c8102e;
            letter-spacing: 4px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.2);
            background: linear-gradient(90deg, #ffd700 0%, #ff8c00 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            line-height: 1.2;
        }
        /* æˆ¿ä¸»æç¤º */
        .host-tip {
            font-size: 16px;
            color: #ff8c00;
            font-weight: bold;
            margin: 8px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            width: 100%;
            padding: 0 5px;
        }
        /* æ¦‚ç‡æ˜¾ç¤ºæ  */
        .current-prob-tip {
            font-size: 14px;
            color: #28a745;
            font-weight: bold;
            margin: 8px 0;
            padding: 6px;
            background-color: rgba(40, 167, 69, 0.1);
            border-radius: 8px;
            width: 100%;
            line-height: 1.5;
        }
        /* æ—¶é—´æ˜¾ç¤º */
        .generate-time {
            margin: 10px 0;
            font-size: 14px;
            color: #8b4513;
            font-weight: bold;
            width: 100%;
            padding: 0 5px;
        }
        /* é˜Ÿä¼ä¿¡æ¯ */
        .team-info {
            margin: 10px 0;
            font-size: 16px;
            color: #c8102e;
            line-height: 1.6;
            width: 100%;
            padding: 0 5px;
        }
        /* æ¦‚ç‡è¾“å…¥æ¡† - å“åº”å¼å¸ƒå±€ */
        .prob-input-group {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            align-items: center;
            flex-wrap: wrap;
            width: 100%;
        }
        .prob-input-item {
            display: flex;
            align-items: center;
            gap: 6px;
            margin: 5px 0;
        }
        .prob-input-item label {
            color: #c8102e;
            font-size: 14px;
            font-weight: bold;
        }
        .prob-input-item input {
            width: 70px;
            padding: 6px 10px;
            border: 2px solid #ffd700;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
            color: #333;
        }
        .prob-input-item input:focus {
            outline: none;
            border-color: #c8102e;
        }
        .percent {
            color: #c8102e;
            font-weight: bold;
        }
        /* æŒ‰é’®æ ·å¼ */
        .btn-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 12px 0;
            width: 100%;
            flex-wrap: wrap;
        }
        button {
            padding: 12px 30px;
            font-size: 16px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px 0;
        }
        .btn-random {
            background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4);
        }
        .btn-prob {
            background: linear-gradient(90deg, #c8102e 0%, #ff4500 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(200, 16, 46, 0.4);
        }
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        /* è§„åˆ™è¯´æ˜ */
        .rule-note {
            margin-top: 20px;
            color: #5a3e2b;
            font-size: 14px;
            line-height: 1.6;
            text-align: left;
            padding: 12px;
            background-color: rgba(255, 248, 230, 0.8);
            border-radius: 10px;
            border-left: 5px solid #c8102e;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŠ åˆ›ä¸šè¥¿å®‰ 2026æ¼è›‹åˆ†ç»„å™¨ ğŸŠ</h1>

        <!-- ä¸Šä¸€æ¬¡åˆ†ç»„å†å²è®°å½•åŒºåŸŸ -->
        <div class="history-section">
            <h3>ğŸ“œ ä¸Šä¸€æ¬¡åˆ†ç»„è®°å½•</h3>
            <div class="history-content" id="history-content">
                <span class="history-empty">æš‚æ— å†å²åˆ†ç»„è®°å½•</span>
            </div>
        </div>
        
        <!-- æ¼è›‹æ¡Œå¸ƒå±€ -->
        <div class="seats-wrapper">
            <div class="seat north">
                <div class="host-tag" style="display: none;">æˆ¿ä¸»</div>
                <div class="direction">åŒ—</div>
                <img class="avatar" id="north-avatar" src="" alt="å¤´åƒ">
                <div class="person" id="north-person">-</div>
            </div>
            <div class="seat south">
                <div class="host-tag" style="display: none;">æˆ¿ä¸»</div>
                <div class="direction">å—</div>
                <img class="avatar" id="south-avatar" src="" alt="å¤´åƒ">
                <div class="person" id="south-person">-</div>
            </div>
            <div class="seat west">
                <div class="host-tag" style="display: none;">æˆ¿ä¸»</div>
                <div class="direction">è¥¿</div>
                <img class="avatar" id="west-avatar" src="" alt="å¤´åƒ">
                <div class="person" id="west-person">-</div>
            </div>
            <div class="seat east">
                <div class="host-tag" style="display: none;">æˆ¿ä¸»</div>
                <div class="direction">ä¸œ</div>
                <img class="avatar" id="east-avatar" src="" alt="å¤´åƒ">
                <div class="person" id="east-person">-</div>
            </div>
            <div class="center-text">åˆ›ä¸šè¥¿å®‰<br>åŠ æ²¹2026</div>
        </div>

        <!-- æ–°å¢ï¼šè£åˆ¤ä¿¡æ¯ -->
        <div class="referee-info">
            ğŸ§‘â€âš–ï¸ è£åˆ¤ï¼šå¾ä¹¦è®°
        </div>

        <!-- æˆ¿ä¸»æç¤º -->
        <div class="host-tip" id="host-tip">æœ¬æ¬¡æˆ¿ä¸»ï¼š<span id="current-host">-</span></div>

        <!-- å®æ—¶æ¦‚ç‡æ˜¾ç¤º -->
        <div class="current-prob-tip" id="current-prob-tip">æœ¬æ¬¡åˆ†ç»„æ¦‚ç‡ï¼šå°é­ä¸é©¬è€æ¿ 33.3% | å°é­ä¸David 33.3% | å°é­ä¸é‚¹æ ¡ 33.4% | å°é­åœ¨é‚¹æ ¡ä¸‹å®¶ 50%ï¼ˆä¸åŒé˜Ÿæ—¶ï¼‰</div>

        <!-- æ—¶é—´æ˜¾ç¤º -->
        <div class="generate-time">ğŸ“… æœ¬æ¬¡åˆ†ç»„ç”Ÿæˆæ—¶é—´ï¼š<span id="generate-time">-</span></div>
        
        <!-- é˜Ÿä¼ä¿¡æ¯ -->
        <div class="team-info">
            <div>ğŸ€œ ä¸œ+è¥¿ é˜Ÿï¼š<span id="team1">-</span></div>
            <div>ğŸ€ å—+åŒ— é˜Ÿï¼š<span id="team2">-</span></div>
        </div>

        <!-- ä¸¤ä¸ªæ¦‚ç‡è¾“å…¥æ¡† -->
        <div class="prob-input-group">
            <div class="prob-input-item">
                <label for="prob-zou">å°é­ä¸é‚¹æ ¡åŒé˜Ÿæ¦‚ç‡ï¼š</label>
                <input type="number" id="prob-zou" min="0" max="100" placeholder="33.4%">
                <span class="percent">%</span>
            </div>
            <div class="prob-input-item">
                <label for="prob-next">å°é­åœ¨é‚¹æ ¡ä¸‹å®¶æ¦‚ç‡ï¼š</label>
                <input type="number" id="prob-next" min="0" max="100" placeholder="50%">
                <span class="percent">%</span>
            </div>
        </div>

        <!-- åˆ†ç»„æŒ‰é’® -->
        <div class="btn-group">
            <button class="btn-random" onclick="generateRandomGroup()">ğŸ² éšæœºåˆ†ç»„</button>
            <button class="btn-prob" onclick="generateProbGroup()">ğŸ¯ æ¦‚ç‡åˆ†ç»„</button>
        </div>

        <!-- åŠ¨æ€è§„åˆ™è¯´æ˜ -->
        <div class="rule-note" id="rule-note">
            <strong>ğŸ¯ æœ¬æ¬¡åˆ†ç»„è§„åˆ™ï¼ˆéšæœºåˆ†ç»„ï¼‰ï¼š</strong><br>
            1. æ‰€æœ‰åˆ†é…å®Œå…¨éšæœºï¼Œå°é­ä¸é©¬è€æ¿/David/é‚¹æ ¡åŒé˜Ÿæ¦‚ç‡ 33.3%/33.3%/33.4%ï¼›<br>
            2. å°é­ä¸é‚¹æ ¡ä¸åŒé˜Ÿæ—¶ï¼Œå°é­åœ¨é‚¹æ ¡ä¸‹å®¶æ¦‚ç‡ä¸º50%ï¼ˆåº§ä½é¡ºåºï¼šä¸œâ†’å—â†’è¥¿â†’åŒ—â†’ä¸œï¼‰ï¼›<br>
            3. éšæœºé€‰æ‹©1äººä½œä¸ºæˆ¿ä¸»ï¼Œæˆ¿ä¸»åº§ä½é‡‘è‰²é«˜äº®ã€‚
        </div>
    </div>

    <script>
        // å¤´åƒæ˜ å°„
        const avatarMap = {
            "é‚¹æ ¡": "https://p9-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/3d754fe9f47b4ca896aba91ea6fe0b36.jpg~tplv-a9rns2rl98-image.png?lk3s=8e244e95&rcl=20260121134801AD78531F66BD8D368B73&rrcfp=dafada99&x-expires=2085198481&x-signature=Gd6lSOJOtC4vyRW73cQEMWWD08E%3D",
            "David": "https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/9a1a60ff466845578d6aca3912d50a61.jpg~tplv-a9rns2rl98-image.png?lk3s=8e244e95&rcl=20260121134801AD78531F66BD8D368B73&rrcfp=dafada99&x-expires=2085198481&x-signature=XmftXWeIhMU1eTz%2BUw0YnwXRtDw%3D",
            "é©¬è€æ¿": "https://p9-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/93eda5e7c1014066991f9a7b4229fe0a.jpg~tplv-a9rns2rl98-image.png?lk3s=8e244e95&rcl=20260121134801AD78531F66BD8D368B73&rrcfp=dafada99&x-expires=2085198481&x-signature=bVV60%2FhVqQ4p4aDAo31AJKlyI9s%3D",
            "å°é­": "https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/667973a943ee4d508cf167d5de7bbbe0.jpg~tplv-a9rns2rl98-image.png?lk3s=8e244e95&rcl=20260121134801AD78531F66BD8D368B73&rrcfp=dafada99&x-expires=2085198481&x-signature=L2kCmu0%2Fmk06KAU1Ch5osfIGaYo%3D"
        };

        const people = ["David", "é‚¹æ ¡", "é©¬è€æ¿", "å°é­"];
        const directions = ["east", "south", "west", "north"];
        const directionOrder = ["east", "south", "west", "north"];
        // é»˜è®¤æ¦‚ç‡å¸¸é‡
        const DEFAULT_PROB_ZOU = 33.4;
        const DEFAULT_PROB_MA = 33.3;
        const DEFAULT_PROB_DAVID = 33.3;
        const DEFAULT_PROB_NEXT = 50;
        // å­˜å‚¨ä¸Šä¸€æ¬¡åˆ†ç»„è®°å½•
        let lastGroupRecord = null;

        // åˆå§‹åŒ–æ‰§è¡Œéšæœºåˆ†ç»„
        generateRandomGroup();

        /**
         * æ ¼å¼åŒ–æ—¶é—´
         */
        function formatTime(date) {
            return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}:${String(date.getSeconds()).padStart(2, '0')}`;
        }

        /**
         * é‡ç½®è¾“å…¥æ¡†ä¸ºé»˜è®¤å ä½ç¬¦
         */
        function resetInputFields() {
            document.getElementById("prob-zou").value = "";
            document.getElementById("prob-next").value = "";
        }

        /**
         * ä¿å­˜åˆ†ç»„è®°å½•
         */
        function saveGroupRecord(seatMap, hostName, generateTime) {
            // ç»„è£…é˜Ÿä¼ä¿¡æ¯
            const team1 = `${seatMap.east} + ${seatMap.west}`;
            const team2 = `${seatMap.south} + ${seatMap.north}`;
            // ä¿å­˜è®°å½•
            lastGroupRecord = {
                team1,
                team2,
                hostName,
                time: generateTime
            };
            // æ›´æ–°å†å²è®°å½•æ˜¾ç¤º
            updateHistoryDisplay();
        }

        /**
         * æ›´æ–°å†å²è®°å½•æ˜¾ç¤º
         */
        function updateHistoryDisplay() {
            const historyContent = document.getElementById("history-content");
            if (!lastGroupRecord) {
                historyContent.innerHTML = '<span class="history-empty">æš‚æ— å†å²åˆ†ç»„è®°å½•</span>';
                return;
            }
            historyContent.innerHTML = `
                é˜Ÿä¼ï¼š${lastGroupRecord.team1} | ${lastGroupRecord.team2}<br>
                æˆ¿ä¸»ï¼š${lastGroupRecord.hostName}<br>
                æ—¶é—´ï¼š${lastGroupRecord.time}
            `;
        }

        /**
         * éšæœºé€‰æˆ¿ä¸»å¹¶é«˜äº®
         */
        function setRandomHost(seatMap) {
            const hostName = people[Math.floor(Math.random() * people.length)];
            let hostDir = "";
            for (const dir of directions) {
                if (seatMap[dir] === hostName) hostDir = dir;
            }

            // æ¸…é™¤æ‰€æœ‰æˆ¿ä¸»æ ·å¼
            directions.forEach(dir => {
                const seat = document.querySelector(`.seat.${dir}`);
                seat.classList.remove("host");
                seat.querySelector(".host-tag").style.display = "none";
            });

            // ç»™æˆ¿ä¸»åº§ä½åŠ æ ·å¼
            if (hostDir) {
                const hostSeat = document.querySelector(`.seat.${hostDir}`);
                hostSeat.classList.add("host");
                hostSeat.querySelector(".host-tag").style.display = "block";
            }
            document.getElementById("current-host").textContent = hostName;
            return hostName;
        }

        /**
         * æ›´æ–°æ¦‚ç‡æ˜¾ç¤ºæ 
         */
        function updateProbTip(type, probZou, probNext) {
            const tipEl = document.getElementById("current-prob-tip");

            if (type === "random") {
                tipEl.textContent = `æœ¬æ¬¡åˆ†ç»„æ¦‚ç‡ï¼šå°é­ä¸é©¬è€æ¿ ${DEFAULT_PROB_MA}% | å°é­ä¸David ${DEFAULT_PROB_DAVID}% | å°é­ä¸é‚¹æ ¡ ${DEFAULT_PROB_ZOU}% | å°é­åœ¨é‚¹æ ¡ä¸‹å®¶ ${DEFAULT_PROB_NEXT}%ï¼ˆä¸åŒé˜Ÿæ—¶ï¼‰`;
            } else if (type === "prob") {
                const isValidZou = !isNaN(probZou) && probZou >= 0 && probZou <= 100;
                const isValidNext = !isNaN(probNext) && probNext >= 0 && probNext <= 100;
                const finalZou = isValidZou ? probZou : DEFAULT_PROB_ZOU;
                const finalNext = isValidNext ? probNext : DEFAULT_PROB_NEXT;
                
                const remain = 100 - finalZou;
                const probMa = Math.round(remain * 10) / 10;
                const probDavid = remain - probMa;

                tipEl.textContent = `æœ¬æ¬¡åˆ†ç»„æ¦‚ç‡ï¼šå°é­ä¸é‚¹æ ¡åŒé˜Ÿ ${finalZou}% | å°é­ä¸é©¬è€æ¿ ${probMa}% | å°é­ä¸David ${probDavid}% | å°é­åœ¨é‚¹æ ¡ä¸‹å®¶ ${finalNext}%ï¼ˆä¸åŒé˜Ÿæ—¶ï¼‰`;
            }
        }

        /**
         * æ›´æ–°è§„åˆ™è¯´æ˜åŒºåŸŸ
         */
        function updateRuleNote(type, probZou, probNext) {
            const ruleEl = document.getElementById("rule-note");

            if (type === "random") {
                ruleEl.innerHTML = `
                    <strong>ğŸ¯ æœ¬æ¬¡åˆ†ç»„è§„åˆ™ï¼ˆéšæœºåˆ†ç»„ï¼‰ï¼š</strong><br>
                    1. æ‰€æœ‰åˆ†é…å®Œå…¨éšæœºï¼Œå°é­ä¸é©¬è€æ¿/David/é‚¹æ ¡åŒé˜Ÿæ¦‚ç‡ ${DEFAULT_PROB_MA}%/${DEFAULT_PROB_DAVID}%/${DEFAULT_PROB_ZOU}%ï¼›<br>
                    2. å°é­ä¸é‚¹æ ¡ä¸åŒé˜Ÿæ—¶ï¼Œå°é­åœ¨é‚¹æ ¡ä¸‹å®¶æ¦‚ç‡ä¸º${DEFAULT_PROB_NEXT}%ï¼ˆåº§ä½é¡ºåºï¼šä¸œâ†’å—â†’è¥¿â†’åŒ—â†’ä¸œï¼‰ï¼›<br>
                    3. éšæœºé€‰æ‹©1äººä½œä¸ºæˆ¿ä¸»ï¼Œæˆ¿ä¸»åº§ä½é‡‘è‰²é«˜äº®ã€‚
                `;
            } else if (type === "prob") {
                const isValidZou = !isNaN(probZou) && probZou >= 0 && probZou <= 100;
                const isValidNext = !isNaN(probNext) && probNext >= 0 && probNext <= 100;
                const finalZou = isValidZou ? probZou : DEFAULT_PROB_ZOU;
                const finalNext = isValidNext ? probNext : DEFAULT_PROB_NEXT;
                const remain = 100 - finalZou;
                const probMa = Math.round(remain * 10) / 10;
                const probDavid = remain - probMa;

                if (!isValidZou && !isValidNext) {
                    ruleEl.innerHTML = `
                        <strong>ğŸ¯ æœ¬æ¬¡åˆ†ç»„è§„åˆ™ï¼ˆæ¦‚ç‡åˆ†ç»„-é»˜è®¤éšæœºï¼‰ï¼š</strong><br>
                        1. è¾“å…¥æ¦‚ç‡æ— æ•ˆï¼ŒæŒ‰éšæœºæ¨¡å¼æ‰§è¡Œï¼Œå°é­ä¸é©¬è€æ¿/David/é‚¹æ ¡åŒé˜Ÿæ¦‚ç‡ ${DEFAULT_PROB_MA}%/${DEFAULT_PROB_DAVID}%/${DEFAULT_PROB_ZOU}%ï¼›<br>
                        2. å°é­ä¸é‚¹æ ¡ä¸åŒé˜Ÿæ—¶ï¼Œå°é­åœ¨é‚¹æ ¡ä¸‹å®¶æ¦‚ç‡ä¸º${DEFAULT_PROB_NEXT}%ï¼ˆåº§ä½é¡ºåºï¼šä¸œâ†’å—â†’è¥¿â†’åŒ—â†’ä¸œï¼‰ï¼›<br>
                        3. éšæœºé€‰æ‹©1äººä½œä¸ºæˆ¿ä¸»ï¼Œæˆ¿ä¸»åº§ä½é‡‘è‰²é«˜äº®ã€‚
                    `;
                } else {
                    ruleEl.innerHTML = `
                        <strong>ğŸ¯ æœ¬æ¬¡åˆ†ç»„è§„åˆ™ï¼ˆæ¦‚ç‡åˆ†ç»„-è‡ªå®šä¹‰ï¼‰ï¼š</strong><br>
                        1. å°é­ä¸é‚¹æ ¡åŒé˜Ÿæ¦‚ç‡ ${finalZou}%ï¼Œä¸é©¬è€æ¿ ${probMa}%ï¼Œä¸David ${probDavid}%ï¼›<br>
                        2. å°é­ä¸é‚¹æ ¡ä¸åŒé˜Ÿæ—¶ï¼Œå°é­åœ¨é‚¹æ ¡ä¸‹å®¶æ¦‚ç‡ä¸º${finalNext}%ï¼ˆåº§ä½é¡ºåºï¼šä¸œâ†’å—â†’è¥¿â†’åŒ—â†’ä¸œï¼‰ï¼›<br>
                        3. éšæœºé€‰æ‹©1äººä½œä¸ºæˆ¿ä¸»ï¼Œæˆ¿ä¸»åº§ä½é‡‘è‰²é«˜äº®ã€‚
                    `;
                }
            }
        }

        /**
         * æ›´æ–°é¡µé¢æ˜¾ç¤º
         */
        function updatePage(seatMap) {
            directions.forEach(dir => {
                document.getElementById(`${dir}-person`).textContent = seatMap[dir];
                document.getElementById(`${dir}-avatar`).src = avatarMap[seatMap[dir]] || "";
            });
            document.getElementById("team1").textContent = `${seatMap.east} + ${seatMap.west}`;
            document.getElementById("team2").textContent = `${seatMap.south} + ${seatMap.north}`;
        }

        /**
         * éšæœºåˆ†ç»„é€»è¾‘
         */
        function generateRandomGroup() {
            resetInputFields();
            const now = new Date();
            const currentTime = formatTime(now);
            document.getElementById("generate-time").textContent = currentTime;

            // æ‰“ä¹±äººå‘˜é¡ºåº
            const randomPeople = [...people].sort(() => Math.random() - 0.5);
            const seatMap = {};
            directions.forEach((dir, i) => seatMap[dir] = randomPeople[i]);

            // æ›´æ–°é¡µé¢å’Œæˆ¿ä¸»
            updatePage(seatMap);
            const hostName = setRandomHost(seatMap);
            // ä¿å­˜å†å²è®°å½•
            saveGroupRecord(seatMap, hostName, currentTime);

            updateProbTip("random");
            updateRuleNote("random");
        }

        /**
         * æ¦‚ç‡åˆ†ç»„é€»è¾‘
         */
        function generateProbGroup() {
            const now = new Date();
            const currentTime = formatTime(now);
            document.getElementById("generate-time").textContent = currentTime;

            const probZouInput = parseFloat(document.getElementById("prob-zou").value);
            const probNextInput = parseFloat(document.getElementById("prob-next").value);

            const isValidZou = !isNaN(probZouInput) && probZouInput >= 0 && probZouInput <= 100;
            const finalZou = isValidZou ? probZouInput : DEFAULT_PROB_ZOU;
            const isValidNext = !isNaN(probNextInput) && probNextInput >= 0 && probNextInput <= 100;
            const finalNext = isValidNext ? probNextInput : DEFAULT_PROB_NEXT;

            const seatMap = { east: "", south: "", west: "", north: "" };
            let xiaoWeiTeammate = "";
            const randomVal = Math.random();

            if (isValidZou) {
                const probZouDecimal = finalZou / 100;
                const remainDecimal = (100 - finalZou) / 100 / 2;
                if (randomVal < remainDecimal) {
                    xiaoWeiTeammate = "é©¬è€æ¿";
                } else if (randomVal < remainDecimal * 2) {
                    xiaoWeiTeammate = "David";
                } else {
                    xiaoWeiTeammate = "é‚¹æ ¡";
                }
            } else {
                const teammates = ["é©¬è€æ¿", "David", "é‚¹æ ¡"];
                xiaoWeiTeammate = teammates[Math.floor(Math.random() * 3)];
            }

            const team1 = ["east", "west"];
            const team2 = ["south", "north"];
            const xiaoWeiTeam = Math.random() > 0.5 ? team1 : team2;
            const otherTeam = xiaoWeiTeam === team1 ? team2 : team1;
            const [xiaoWeiDir, mateDir] = Math.random() > 0.5 ? [xiaoWeiTeam[0], xiaoWeiTeam[1]] : [xiaoWeiTeam[1], xiaoWeiTeam[0]];
            seatMap[xiaoWeiDir] = "å°é­";
            seatMap[mateDir] = xiaoWeiTeammate;

            const remainPeople = people.filter(p => p !== "å°é­" && p !== xiaoWeiTeammate);
            let zou = remainPeople.find(p => p === "é‚¹æ ¡") || "";
            let other = remainPeople.find(p => p !== zou) || "";

            if (xiaoWeiTeammate !== "é‚¹æ ¡" && zou) {
                if (Math.random() < finalNext / 100) {
                    const xiaoWeiIdx = directionOrder.indexOf(xiaoWeiDir);
                    const zouIdx = (xiaoWeiIdx - 1 + 4) % 4;
                    const zouDir = directionOrder[zouIdx];
                    if (otherTeam.includes(zouDir)) {
                        seatMap[zouDir] = zou;
                        seatMap[otherTeam.find(d => d !== zouDir)] = other;
                    } else {
                        seatMap[otherTeam[0]] = zou;
                        seatMap[otherTeam[1]] = other;
                    }
                } else {
                    const xiaoWeiIdx = directionOrder.indexOf(xiaoWeiDir);
                    const zouIdx = (xiaoWeiIdx - 1 + 4) % 4;
                    const zouDir = directionOrder[zouIdx];
                    const availableDirs = otherTeam.filter(dir => dir !== zouDir);
                    if (availableDirs.length > 0) {
                        const [zouTargetDir, otherDir] = Math.random() > 0.5 ? [availableDirs[0], availableDirs[1] || otherTeam[0]] : [availableDirs[1] || otherTeam[1], availableDirs[0]];
                        seatMap[zouTargetDir] = zou;
                        seatMap[otherDir] = other;
                    } else {
                        seatMap[otherTeam[0]] = other;
                        seatMap[otherTeam[1]] = zou;
                    }
                }
            } else {
                seatMap[otherTeam[0]] = other;
                seatMap[otherTeam[1]] = zou;
            }

            directions.forEach(dir => {
                if (!seatMap[dir]) {
                    const unassigned = people.find(p => !Object.values(seatMap).includes(p));
                    if (unassigned) seatMap[dir] = unassigned;
                }
            });

            updatePage(seatMap);
            const hostName = setRandomHost(seatMap);
            saveGroupRecord(seatMap, hostName, currentTime);

            updateProbTip("prob", probZouInput, probNextInput);
            updateRuleNote("prob", probZouInput, probNextInput);
        }
    </script>
</body>
</html>